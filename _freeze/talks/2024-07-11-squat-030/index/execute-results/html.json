{
  "hash": "d68984c7e5e40615d727d15f1b083afe",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"[**squat**](https://lmjl-alea.github.io/squat/index.html)\"\nsubtitle: \"Statistics for studying 3D object orientations over time\"\nauthor:\n  - name: L. Bellanger\n    affiliation: Department of Mathematics Jean Leray, UMR CNRS 6629, Nantes University, Ecole Centrale de Nantes, France\n  - name: A. Stamm\n    affiliation: Department of Mathematics Jean Leray, UMR CNRS 6629, Nantes University, Ecole Centrale de Nantes, France\n    corresponding: true\n    orcid: 0000-0002-8725-3654\nformat:\n  revealjs:\n    footer: \"userR! 2024 - Salzburg - <aymeric.stamm@cnrs.fr>\"\n    slide-number: true\n    logo: images/logo-lmjl.png\n    date: 2024-07-11\n    theme: simple\n    scrollable: false\nlightbox: auto\nbibliography: references.bib\nimage: user2024.png\n---\n\n\n\n\n# Context\n\n## The eGait project\n\n::: {.callout-note title=\"Two key numbers in France\"}\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"card bslib-card bslib-mb-spacing html-fill-item html-fill-container bslib-value-box bg-primary showcase-left-center\" data-bslib-card-init data-require-bs-caller=\"card() value_box()\" data-require-bs-version=\"5 5\">\n<div class=\"card-body bslib-gap-spacing html-fill-item html-fill-container\" style=\"margin-top:auto;margin-bottom:auto;flex:1 1 auto; padding:0;\">\n<div class=\"value-box-grid html-fill-item\" style=\"--bslib-grid-height:auto;--bslib-grid-height-mobile:auto;---bslib-value-box-showcase-w:30%;---bslib-value-box-showcase-w-fs:1fr;---bslib-value-box-showcase-max-h:100px;---bslib-value-box-showcase-max-h-fs:67%;\">\n<div class=\"value-box-showcase html-fill-item html-fill-container\"><svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 640 512\" style=\"height:1em;width:1.25em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M232 0c-39.8 0-72 32.2-72 72v8H72C32.2 80 0 112.2 0 152V440c0 39.8 32.2 72 72 72h.2 .2 .2 .2 .2H73h.2 .2 .2 .2 .2 .2 .2 .2 .2 .2H75h.2 .2 .2 .2 .2 .2 .2 .2 .2 .2H77h.2 .2 .2 .2 .2 .2 .2 .2 .2 .2H79h.2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2H82h.2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2H85h.2 .2 .2 .2H86h.2 .2 .2 .2H87h.2 .2 .2 .2H88h.2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2H98h.2 .2 .2 .2H99h.2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2 .2v0H456h8v0H568c39.8 0 72-32.2 72-72V152c0-39.8-32.2-72-72-72H480V72c0-39.8-32.2-72-72-72H232zM480 128h88c13.3 0 24 10.7 24 24v40H536c-13.3 0-24 10.7-24 24s10.7 24 24 24h56v48H536c-13.3 0-24 10.7-24 24s10.7 24 24 24h56V440c0 13.3-10.7 24-24 24H480V336 128zM72 128h88V464h-.1-.2-.2-.2H159h-.2-.2-.2H158h-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2H154h-.2-.2-.2H153h-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2H150h-.2-.2-.2H149h-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2H146h-.2-.2-.2H145h-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2H142h-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2H139h-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2H136h-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2H133h-.2-.2-.2-.2-.2-.2-.2-.2H131h-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2H128h-.2-.2-.2-.2-.2-.2-.2-.2H126h-.2-.2-.2-.2-.2-.2-.2-.2H124h-.2-.2-.2-.2-.2-.2-.2-.2H122h-.2-.2-.2-.2-.2-.2-.2-.2H120h-.2-.2-.2-.2-.2-.2-.2-.2H118h-.2-.2-.2-.2-.2-.2-.2-.2H116h-.2-.2-.2-.2-.2-.2-.2-.2H114h-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2H111h-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2H108h-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2H105h-.2-.2-.2-.2H104h-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2H100h-.2-.2-.2-.2H99h-.2-.2-.2-.2H98h-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2H88h-.2-.2-.2-.2H87h-.2-.2-.2-.2H86h-.2-.2-.2-.2H85h-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2H82h-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2H79h-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2H77h-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2H75h-.2-.2-.2-.2-.2-.2-.2-.2-.2-.2H73h-.2-.2-.2-.2-.2H72c-13.2 0-24-10.7-24-24V336h56c13.3 0 24-10.7 24-24s-10.7-24-24-24H48V240h56c13.3 0 24-10.7 24-24s-10.7-24-24-24H48V152c0-13.3 10.7-24 24-24zM208 72c0-13.3 10.7-24 24-24H408c13.3 0 24 10.7 24 24V336 464H368V400c0-26.5-21.5-48-48-48s-48 21.5-48 48v64H208V72zm88 24v24H272c-8.8 0-16 7.2-16 16v16c0 8.8 7.2 16 16 16h24v24c0 8.8 7.2 16 16 16h16c8.8 0 16-7.2 16-16V168h24c8.8 0 16-7.2 16-16V136c0-8.8-7.2-16-16-16H344V96c0-8.8-7.2-16-16-16H312c-8.8 0-16 7.2-16 16z\"/></svg></div>\n<div class=\"value-box-area html-fill-item html-fill-container\">\n<p class=\"value-box-title\">Multiple Sclerosis</p>\n<p class=\"value-box-value\">100,000</p>\n</div>\n</div>\n</div>\n<script data-bslib-card-init>bslib.Card.initializeAllCards();</script>\n</div>\n```\n\n:::\n:::\n\n\n:::\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"card bslib-card bslib-mb-spacing html-fill-item html-fill-container bslib-value-box bg-primary showcase-left-center\" data-bslib-card-init data-require-bs-caller=\"card() value_box()\" data-require-bs-version=\"5 5\">\n<div class=\"card-body bslib-gap-spacing html-fill-item html-fill-container\" style=\"margin-top:auto;margin-bottom:auto;flex:1 1 auto; padding:0;\">\n<div class=\"value-box-grid html-fill-item\" style=\"--bslib-grid-height:auto;--bslib-grid-height-mobile:auto;---bslib-value-box-showcase-w:30%;---bslib-value-box-showcase-w-fs:1fr;---bslib-value-box-showcase-max-h:100px;---bslib-value-box-showcase-max-h-fs:67%;\">\n<div class=\"value-box-showcase html-fill-item html-fill-container\"><svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 640 512\" style=\"height:1em;width:1.25em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M192 48c0-26.5 21.5-48 48-48H400c26.5 0 48 21.5 48 48V512H368V432c0-26.5-21.5-48-48-48s-48 21.5-48 48v80H192V48zM48 96H160V512H48c-26.5 0-48-21.5-48-48V320H80c8.8 0 16-7.2 16-16s-7.2-16-16-16H0V224H80c8.8 0 16-7.2 16-16s-7.2-16-16-16H0V144c0-26.5 21.5-48 48-48zm544 0c26.5 0 48 21.5 48 48v48H560c-8.8 0-16 7.2-16 16s7.2 16 16 16h80v64H560c-8.8 0-16 7.2-16 16s7.2 16 16 16h80V464c0 26.5-21.5 48-48 48H480V96H592zM312 64c-8.8 0-16 7.2-16 16v24H272c-8.8 0-16 7.2-16 16v16c0 8.8 7.2 16 16 16h24v24c0 8.8 7.2 16 16 16h16c8.8 0 16-7.2 16-16V152h24c8.8 0 16-7.2 16-16V120c0-8.8-7.2-16-16-16H344V80c0-8.8-7.2-16-16-16H312z\"/></svg></div>\n<div class=\"value-box-area html-fill-item html-fill-container\">\n<p class=\"value-box-title\">Parkinson's disease</p>\n<p class=\"value-box-value\">160,000</p>\n</div>\n</div>\n</div>\n<script data-bslib-card-init>bslib.Card.initializeAllCards();</script>\n</div>\n```\n\n:::\n:::\n\n\n:::\n\n::::\n\n:::\n\n::: {.callout-note title=\"Two key observations\"}\n- **Gait impairment**: major symptom impacting quality of daily life;\n- **Clinical gait assessment** mostly **qualitative** and **biased**:\n  - Only in a constrained environment (as opposed to free-living environment);\n  - Mainly based on the expertise of the neurologist;\n  - Quantitative measures boil down to timing a given walking distance.\n:::\n\n## The eGait device {.smaller}\n\n- An inertial measurement unit (IMU): **defines** the data (rotations over time),\n- A smartphone application: **collects** the data,\n- Statistical methods for rotation-valued functional data: **analyses** the data\n\n::: {#fig-egait layout-ncol=3 layout-valign=\"bottom\"}\n![Data recording](images/egait-device-sensor.png){#fig-sensor}\n\n![Smartphone & App](images/egait-device-app.png){#fig-app}\n\n![Rotation data](images//hip.gif){#fig-rotation}\n\nThe eGait device [@brard2022novel;@drouin2022amelioration;@drouin2023semi;@ballante2023smoothing].\n:::\n\n## Rotation data\n\n:::: {.columns}\n\n::: {.column width=\"32%\"}\n![Rotation matrix.](images/fig-rotation-matrix.jpeg){group=\"rotation\"}\n:::\n\n::: {.column width=\"32%\"}\n![Roll-pitch-yaw angles. Courtesy of [Wikimedia Commons](https://commons.wikimedia.org/wiki/File:Flight_dynamics_with_text_ortho.svg). [CC-BY-SA 4.0](https://creativecommons.org/licenses/by-sa/4.0/).](images/fig-rpy.png){group=\"rotation\"}\n:::\n\n::: {.column width=\"32%\"}\n![Axis-angle representation.](images/fig-axis-angle.png){group=\"rotation\"}\n:::\n\n::::\n\n## Rotation data\n\n::: {.callout-tip title=\"Unit quaternions\"}\nUnit quaternions are hypercomplex numbers (Hamilton) of unit norm that encode a 3D rotation via:\n\n$$\n\\mathbf{q} = (q_w, q_x, q_y, q_z) = \\left(\\cos \\frac{\\theta}{2}, i v_x \\sin \\frac{\\theta}{2}, j v_y \\sin \\frac{\\theta}{2}, k v_z \\sin \\frac{\\theta}{2}  \\right),\n$$\n\nwhere:\n\n- $\\mathbf{v} = (v_x, v_y, v_z)^\\top$ and $\\theta$ are resp. axis and angle of rotation,\n- $i$, $j$ and $k$ are s.t. $i^2 = j^2 = k^2 = ijk = −1$ and $\\| q \\| = 1$.\n:::\n\n## Mathematics of quaternions\n\n::: {layout-ncol=2}\n\n::: {.callout-warning title=\"Algebra of unit quaternion\"}\n*Usual* addition and scalar multiplication do not apply.\n\n$$\n\\| q_1 + q_2 \\| \\ne 1 \\quad \\| \\lambda q \\| \\ne 1\n$$\n\nMultiplication follows Hamilton's rule:\n\n$$\n\\mathbf{p} \\mathbf{q} = \\begin{pmatrix}\np_w q_w + p_x q_x + p_y q_y + p_z q_z \\\\\np_w q_x - p_x q_w - p_y q_z + p_z q_y \\\\\np_w q_y + p_x q_z - p_y q_w - p_z q_x \\\\\np_w q_z - p_x q_y + p_y q_x - p_z q_w\n\\end{pmatrix}\n$$\n:::\n\n::: {.callout-tip title=\"Lie group of unit quaternions\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](images/liegroups3.png){width=533}\n:::\n:::\n\n\n@sola2018micro\n:::\n\n:::\n\n# The [**squat**](https://lmjl-alea.github.io/squat/index.html) package\n\n## Using the [Eigen](https://eigen.tuxfamily.org/index.php?title=Main_Page) library\n\n::: {style=\"font-size: 50%;\"}\n> Eigen is a C++ template library for linear algebra: matrices, vectors, numerical solvers, and related algorithms.\n:::\n\n::: {.callout-note title=\"Quaternion class\"}\n::: {.columns}\n:::: {.column width=50%}\n- Conversion to other matrix representations;\n- Geodesic distance;\n- Conjugate / inverse;\n- Hamilton product;\n::::\n:::: {.column width=50%}\n- Norm computation and normalization;\n- Dot product;\n- Spherical linear interpolation (SLERP);\n- Random quaternion generation.\n::::\n:::\n:::\n\n::: {#title-slide .center .callout-tip title=\"How to use Eigen in R?\"}\n[**RcppEigen**](https://dirk.eddelbuettel.com/code/rcpp.eigen.html)\n:::\n\n## QTS class for quaternion time series\n\n::: {.columns}\n\n:::: {.column width=50%}\n\n::: {.callout-note title=\"The `qts` class\" icon=false}\nA [tibble](https://tibble.tidyverse.org/reference/tibble.html) with 5 columns:\n\n- `time`: Time points at which quaternions were collected;\n- `w`   : 1st coord. of each quaternion;\n- `x`   : 2nd coord. of each quaternion;\n- `y`   : 3rd coord. of each quaternion;\n- `z`   : 4th coord. of each quaternion.\n:::\n\n::::\n\n:::: {.column width=50%}\n\n::: {.callout-note title=\"An example\" icon=false}\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n| time|         w|         x|         y|         z|\n|----:|---------:|---------:|---------:|---------:|\n|    0| 0.9942745| 0.0797319| 0.0698791| 0.0133386|\n|    1| 0.9948330| 0.0745706| 0.0676322| 0.0131288|\n|    2| 0.9954224| 0.0693108| 0.0645704| 0.0126874|\n|    3| 0.9960205| 0.0639757| 0.0609104| 0.0118434|\n|    4| 0.9965184| 0.0594915| 0.0574216| 0.0107045|\n|    5| 0.9969400| 0.0557187| 0.0540293| 0.0093213|\n|    6| 0.9972854| 0.0527473| 0.0507937| 0.0077156|\n\n\n:::\n:::\n\n:::\n\n::::\n\n:::\n\n## Methods for QTS objects\n\n::: {.columns}\n\n:::: {.column width=50%}\n\n::: {.callout-note title=\"List of methods\" icon=false}\n[**RcppEigen**](https://dirk.eddelbuettel.com/code/rcpp.eigen.html) for interfacing with [Eigen](https://eigen.tuxfamily.org/index.php?title=Main_Page):\n\n- `centring()`;\n- `ggplot2::autoplot()`;\n- `graphics::plot()`;\n- `+`, `-`, `*`, `inverse_qts()`.\n:::\n\n::::\n\n:::: {.column width=50%}\n\n::: {.callout-note title=\"An example\" icon=false}\n\n::: {.cell}\n\n```{.r .cell-code}\nvespa64$igp[[1]] * vespa64$igp[[2]]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 101 × 5\n    time         w         x         y         z\n   <int> <dec:.5!> <dec:.5!> <dec:.5!> <dec:.5!>\n 1     0   0.97621   0.16129   0.14303   0.02323\n 2     1   0.97856   0.15079   0.13832   0.02344\n 3     2   0.98096   0.14017   0.13241   0.02327\n 4     3   0.98339   0.12929   0.12539   0.02235\n 5     4   0.98557   0.11930   0.11828   0.02086\n 6     5   0.98744   0.11058   0.11124   0.01875\n 7     6   0.98894   0.10387   0.10465   0.01602\n 8     7   0.99017   0.09883   0.09812   0.01261\n 9     8   0.99126   0.09487   0.09128   0.00851\n10     9   0.99225   0.09158   0.08394   0.00386\n# ℹ 91 more rows\n```\n\n\n:::\n:::\n\n:::\n\n::::\n\n:::\n\n## QTS sample class\n\nThe `qts_sample` class is a list of `qts` objects.\n\n::: {.callout-note title=\"List of methods\" icon=false}\n- `as_qts_sample()`, `is_qts_sample()`, `[`;\n- `append()`;\n- `rnorm_qts()`;\n- `scale()`;\n- `mean()`, `median()`;\n- `autoplot()`, `plot()`.\n:::\n\n## Manipulating (sets of) QTS\n\nA number of methods which can be applied to both the `qts` and `qts_sample` classes.\n\n::: {.callout-note title=\"List of selected methods\" icon=false}\n- `log()` and `exp()`: maps from and to the Lie algebra;\n- `normalize()`: ensures that all quaternions in the time series are unit\nquaternions;\n- `resample()`: performs uniform resampling using SLERP;\n- `smooth()`: performs smoothing of a QTS by SLERP interpolation;\n- `moving_average()`: performs QTS smoothing via moving average;\n- `hemispherize()`: ensures that there are no discontinuities in QTS due to quaternion flips since two unit quaternions $\\mathbf{q}$ and $-\\mathbf{q}$ encode the same rotation.\n:::\n\n## Transformation to other representations {visibility=\"hidden\"}\n\nA number of methods which can be applied to both the `qts` and `qts_sample` classes.\n\n::: {.callout-note title=\"List of methods\" icon=false}\n- `qts2dts()`: Transformation To Distance Time Series;\n- `qts2aats()`: Transformation to Axis-Angle Time Series;\n- `qts2rpyts()`: Transformation To Roll-Pitch-Yaw Time Series;\n- `qts2nts()`: Transformation To Norm Time Series;\n- `qts2ats()`: Transformation To Angle Time Series;\n- `qts2avts()`: Transformation to Angular Velocity Time Series.\n:::\n\n# An example of analysis with the [**squat**](https://lmjl-alea.github.io/squat/) package\n\n## Individual Gait Patterns {.smaller}\n\n::: {style=\"width: 65%; margin-left: 15%;\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-6-1.png){width=960}\n:::\n:::\n\n:::\n\n::: {style=\"width: 70%; margin-left: 18%;\"}\n![@cheung2017androgen](images/gait-cycle.png)\n:::\n\n## From IGP space to $L^2$ space\n\n::: {.columns}\n\n:::: {.column width=50%}\n\n::: {.callout-note title=\"Original manifold $\\mathbb{S}^3$\" icon=false}\n$$\n\\scriptsize{\n\\begin{array}{rccc}\n\\mathbf{q}: & [0,1] & \\to & \\mathbb{S}^3 \\\\\n& s & \\mapsto & \\mathbf{q}(s)\n\\end{array}\n}\n$$\n:::\n\n::::\n\n:::: {.column width=50%}\n\n::: {.callout-tip title=\"Tangent space $\\mathcal{T}\\mathbb{S}^3 \\approx \\mathbb{R}^3$\"}\n$$\n\\scriptsize{\n\\begin{array}{rccc}\n\\mathbf{t}: & [0,1] & \\to & \\mathbb{R}^3 \\\\\n& s & \\mapsto & \\log(\\mathbf{q}(s)) = (\\theta(s) / 2) \\mathbf{v}(s)\n\\end{array}\n}\n$$\n:::\n\n::::\n\n:::\n\n::: {.callout-tip title=\"Square-root velocity space $L^2 \\left( [0, 1], \\mathbb{R}^3 \\right)$ [@srivastava2016functional]\"}\n$$\n\\scriptsize{\n\\begin{array}{rccc}\n\\mathbf{g}: & [0,1] & \\to & \\mathbb{R}^3 \\\\\n& s & \\mapsto &\n\\begin{cases}\n\\frac{\\mathbf{t}^\\prime(s))}{\\sqrt{\\| \\mathbf{t}^\\prime(s)) \\|}} & \\text{if } \\mathbf{t}^\\prime(s) \\neq 0 \\\\\n0 & \\text{otherwise}\n\\end{cases}\n\\end{array}\n}\n$$\n:::\n\n## Adding geometric invariants {visibility=\"hidden\"}\n\n::: {.callout-tip title=\"Rotational invariance [@kurtek2012statistical;@srivastava2016functional]\"}\nTwo IGPs that only differ by a rotation of the sensor should be considered equal.\n\n$$\nd(\\mathbf{q}_1, \\mathbf{q}_2) = \\min_{R \\in \\mathrm{SO}(3)} \\left\\| \\mathbf{v}_1 - R \\mathbf{v}_2 \\right\\|_{L^2}\n$$\n:::\n\n::: {.callout-tip title=\"Parametrization-invariance [@kurtek2012statistical;@srivastava2016functional]\"}\nTo make IGPs invariant to reparametrization, one can further minimize over the\nset of boundary-preserving diffeomorphisms $\\Gamma$ of $[0,1]$:\n\n$$\nd_a(\\mathbf{q}_1, \\mathbf{q}_2) = \\min_{\\gamma \\in \\Gamma} \\min_{R \\in \\mathrm{SO}(3)} \\left\\| \\mathbf{v}_1 - R \\mathbf{v}_2 \\circ \\gamma \\right\\|_{L^2}\n$$\n:::\n\n## Statistical analyses\n\n::: {.callout-note title=\"Clustering - *Deps:* [**fdacluster**](https://astamm.github.io/fdacluster/index.html), [**fdasrvf**](https://cran.r-project.org/package=fdasrvf), [**dbscan**](https://cran.r-project.org/package=dbscan) [@sangalli2010k;@vantini2012definition]\"}\n- `S3` impl. of `kmeans()`, `hclust()` and `dbscan()` for `qts_sample` objects;\n- Return an object of class `qtsclust`;\n- `S3` impl. of `autoplot()` and `plot()` for `qtsclust` objects for visualization.\n:::\n\n::: {.callout-note title=\"PCA - *Deps:* [**MFPCA**](https://cran.r-project.org/package=MFPCA) [@happ2018multivariate;@happ2020object]\"}\n- `S3` impl. of `prcomp()` for `qts_sample` objects;\n- Returns an object of class `prcomp_qts`;\n- `S3` impl. of `autoplot()`, `plot()` and `predict()` for `prcomp_qts` objects for easy visualizations and prediction.\n:::\n\n## Clustering Example\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkm <- kmeans(\n  x = vespa64$igp, # object of class qts_sample\n  n_clusters = 2, # number of clusters to find\n  seeding_strategy = \"kmeans++\", # various seeding strategies\n  is_domain_interval = TRUE, # are curves defined on a fixed common interval?\n  transformation = \"srsf\", # transformation to apply to the curves\n  warping_class = \"bpd\", # warping class to use\n  metric = \"l2\" # distance metric to use\n)\n```\n:::\n\n::: {.cell layout-ncol=\"3\" lightbox='{\"group\":\"clustering\"}'}\n\n```{.r .cell-code}\nplot(km)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-8-1.png){width=960}\n:::\n\n```{.r .cell-code}\nplot(km$best_clustering, type = \"amplitude\") # S3 specialization for `caps` objects\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-8-2.png){width=960}\n:::\n\n```{.r .cell-code}\nplot(km$best_clustering, type = \"phase\") # S3 specialization for `caps` objects\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-8-3.png){width=960}\n:::\n:::\n\n\n## PCA Example\n\n\n::: {.cell}\n\n```{.r .cell-code}\npca <- prcomp(\n  x = vespa64$igp, # object of class qts_sample\n  M = 5L, # number of principal components to keep\n  fit = FALSE # should a reconstruction of the sample from the retained PCs be stored?\n)\n```\n:::\n\n::: {.cell layout-ncol=\"3\" lightbox='{\"group\":\"pca\"}'}\n\n```{.r .cell-code}\nscreeplot(pca)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-10-1.png){width=960}\n:::\n\n```{.r .cell-code}\nplot(pca, what = \"PC1\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-10-2.png){width=960}\n:::\n\n```{.r .cell-code}\nautoplot(pca, what = \"scores\") + geom_point(aes(color = vespa64$V))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-10-3.png){width=960}\n:::\n:::\n\n\n## Wrappin' up\n\nThe [**squat**](https://lmjl-alea.github.io/squat/index.html) package currently\nallows you to analyze time series of 3D object orientations\n\n- seamlessly for clustering and PCA;\n- with a bit of extra work for other analyses (e.g. regression/prediction) via the provided `exp()` and `log()` maps.\n\nDo not hesitate to create an issue on the [GitHub\nrepository](https://github.com/LMJL-Alea/squat/issues) if you want other\nstatistical analyses to be implemented in the same way as the clustering and\nPCA.\n\n## References\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/bslib-component-js-0.7.0/components.min.js\"></script>\n<script src=\"../../site_libs/bslib-component-js-0.7.0/web-components.min.js\" type=\"module\"></script>\n<link href=\"../../site_libs/bslib-component-css-0.7.0/components.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/bslib-tag-require-0.7.0/tag-require.js\"></script>\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}